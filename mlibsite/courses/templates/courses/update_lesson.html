{% extends 'base.html' %}
{% block content %}
<form class="form-group" method="post" enctype="multipart/form-data">
  {{form.hidden_tag()}}
  <br>
  <div class="jumbotron" align="center">

    <div class="container">
      <div class="row">
        <div class="col-sm" align='left'>
          <img align='center' height='200px' src="{{label_image}}">
        </div>
        <div class="col-lg" align='center'>
          <h2>Редактирование занятия курса</h2>
          <h5><a class="text-body text-decoration-none" href="{{url_for('projects.project_view', project_id=project.id)}}">{{project.name}}</a></h5>
          <h5><a class="text-body text-decoration-none" href="{{url_for('projects.term_view', term_id=term.id)}}">{{term.name}}</a></h5>
          <h5><a class="text-body text-decoration-none" href="{{url_for('courses.course_view', course_id=course.id)}}">{{course.name}}</a></h5>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="form-group">
      {{form.description.label(class='form-control-label')}}
      {{form.description(class='form-control form-control', rows="5")}}
    </div>
    <table width='100%'>
      <tr>
        <td width='40%'>
          <div class="form-group">
            {{form.lesson_date.label(class='form-control-label')}}
            {{form.lesson_date(class='form-control form-control')}}
          </div>
        </td>
        <td>
          <div class="form-group">
            {{form.start_time.label(class='form-control-label')}}
            {{form.start_time(class='form-control form-control')}}
          </div>
        </td>
        <td>
          <div class="form-group">
            {{form.finish_time.label(class='form-control-label')}}
            {{form.finish_time(class='form-control form-control')}}
          </div>
        </td>
      </tr>
    </table>
    <div class="form-group">
      {{form.method_id.label(class='form-control-label')}}
      {% if method %}
        {{method.title}}
        <div align='right'>
          <a class='btn btn-outline-warning btn-sm' href="{{url_for('methodics.search_method', category=1)}}" title="Выбрать методику для занятия">Поменять методику</a>
        </div>
      {% else %}
        <a class='btn btn-outline-danger btn-sm' href="{{url_for('methodics.search_method', category=1)}}" title="Выбрать методику для занятия">Выбрать методику</a>
      {% endif %}

      <!-- {{form.method_id(class='form-control form-control')}} -->
    </div>
    <div class="form-group">
      {{form.tutors.label(class='form-control-label')}}
      {{form.tutors(class='form-control form-control')}}
    </div>
    <div class="form-group">
      {{form.absent_students_list.label(class='form-control-label')}}
      {{form.absent_students_list(class='form-control form-control')}}
    </div>
    <div class="form-group">
      {{form.web_links.label(class='form-control-label')}}
      {{form.web_links(class='form-control form-control')}}
    </div>
    <div class="form-group">
      {{form.note.label(class='form-control-label')}}
      {{form.note(class='form-control form-control')}}
    </div>
    <!-- Блок работы с прикрепленными файлами -->
    {% if attachments %}
      <!-- Прикрепленные файлы: -->
      <table class="table table-sm">
        <tr class="table-info">
          <th scope="col">Прикрепленные файлы:</th>
          <th></th>
        </tr>
        {% for attachment in attachments %}
          <tr>
            <td> {{attachment}}</td>
            <td align='center'> <a class='btn btn-outline-success btn-sm' href="{{url_for('courses.download_lesson_attachment', lesson_id=lesson.id, attachment=attachment)}}">Скачать</a>
            <a class='btn btn-outline-danger btn-sm' href="{{url_for('courses.delete_lesson_attachment', lesson_id=lesson.id, attachment=attachment)}}">Удалить</a></td>
          </tr>
        {% endfor %}
      </table>
      <div class="form-group">
        Для добавления еще одного файла (pdf, pptx, docx, txt)
        {{form.attach(class='form-control-file')}}
      </div>
    {% else %}
    <div class="form-group">
      {{form.attach.label(class='form-control-label')}}
      {{form.attach(class='form-control-file')}}
    </div>
    {% endif %}
    <div class="form-group" align='right'>
      {{form.submit(class='btn btn-outline-info')}}
    </div>
  </div>
</form>
{% endblock %}
